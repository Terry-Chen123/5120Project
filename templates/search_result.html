{% extends 'base.html' %}
{% block mapstyle %}
<style>
	body { margin: 0; padding: 0; }
	#map {
        position: absolute;
        top: 100px;
        bottom: 0;
        left:660px;
        width: 750px;
        height:620px;
    }

</style>
{% endblock %}

{% block navigation %}
    <li ><a href="{% url 'Home' %}">Home</a></li>
    <li><a href="{% url 'About' %}">About</a></li>
    <li ><a href="{% url 'Read More' %}">More Information</a></li>
    <li class="active"><a href="{% url 'Service' %}">Service</a></li>
{% endblock %}


{% block mainbody %}
    {% load static %}

    <!-- search section -->
    <div class="ftco-blocks-cover-1">
        <div class="ftco-cover-1 overlay" style="background-image:url('{% static 'img/search/5.png' %}');
                                                 background-repeat:no-repeat;
                                                 background-position: center;background-size:100% 100%;
                                                ">
          <div class="container">
            <div class="row align-items-center">
              <div class="col-lg-6" style="height: 500px" >
                  <br><br><br>
                <h1><font color="2E8B57">Find a Clinic </font></h1>
                <p class="mb-5"><font color="#696969">
                    Getting vaccinated is one of the most effective ways to prevent pneumonia.<br>
                    It is kind that parents can search for a clinic for consultation.<br>
                    There are more than 300 available clinics and hospitals in Victoria, and we are pleased to deliver the basic info for each clinic or hospital.
                </font></p>
                <a href='{% url 'Search' %}'><input type="submit"  class="btn  text-white px-4 " style="background-color: #34ce57; height: 58px;" value="Back to Search Page">&nbsp;</a>
              </div>
            </div>
          </div>
        </div>
    </div>
    <!-- search section end-->

	<!-- search result section -->
	<section class="contact-section spad">
		<div class="container">
			<div class="row">
				<div class="col-lg-6">
					<div class="contact-text">
						<h3>View Hospital Location on Map</h3>
                        <h1>{{ result }}</h1>
                        <img src="{% static 'img/search/1.png' %}" style="height:300px ;width:500px;margin-bottom: 40px">
						<div class="contact-info">
							<div class="ci-image set-bg" data-setbg="{% static 'img/hospital.png'%}"></div>
							<div class="ci-content">
								<h4><font color="2E8B57">{{ hospital.hospital_name }}</font> </h4><br>
                                    <h5>State: {{ hospital.state }} {{ hospital.postcode }}</h5><br>
                                    <h5>Road: {{ hospital.roadName }} {{ hospital.streetNum }}</h5><br>
                                    <h5>Phone: {{ hospital.phone}}</h5>
							</div>
						</div>
					</div>
                </div>
            </div>
        </div>
        <script src='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.2.0/mapbox-gl-geocoder.min.js'></script>
        <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.5.1/mapbox-gl-geocoder.min.js"></script>
        <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.5.1/mapbox-gl-geocoder.css"  type="text/css"  />
        <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-directions/v4.1.0/mapbox-gl-directions.js"></script>
        <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-directions/v4.1.0/mapbox-gl-directions.css" type="text/css"/>

        <div id="map"></div>

        <script>
            var new_lat = {{ hospital.latitude }}
            var new_long = {{ hospital.longitude }}
            mapboxgl.accessToken = 'pk.eyJ1IjoidGVycnljYXJyeXUiLCJhIjoiY2syNXFvYmd4MDg2bjNidGw1YnlsbndhayJ9.TGdaiRtA3NWwce3jDYrR1g';
            var map = new mapboxgl.Map({
            container: 'map',
            style: 'mapbox://styles/mapbox/streets-v11',
            center: [new_long,new_lat ],
            zoom: 10
            });

             var geocoder = new MapboxGeocoder({ // Initialize the geocoder
                  accessToken: mapboxgl.accessToken, // Set the access token
                  mapboxgl: mapboxgl, // Set the mapbox-gl instance
                  marker: false, // Do not use the default marker style
                  placeholder: 'Search in Melbourne', // Placeholder text for the search bar
                  bbox: [140.6, -39.3, 150.3, -33.8], // Boundary for Berkeley
                  proximity: {
                    longitude: 144.946457,
                    latitude: -37.840935
                  } // Coordinates of Melbourne
                });
            map.addControl(geocoder);

            //zoom in and out function
            map.addControl(new mapboxgl.NavigationControl());

            // locate yourself.
            map.addControl(
                new mapboxgl.GeolocateControl({
                positionOptions: {
                enableHighAccuracy: true
                },
                trackUserLocation: true
                })
            );;

            //direction
            map.addControl(
            new MapboxDirections({
            accessToken: mapboxgl.accessToken
            }),
            'top-left'
            );

            //var hospitalName = {{ hospital.hospital_name }}

            //offset: the distance between marker and text
            var popup = new mapboxgl.Popup({ offset: 50 }).setText(
            'Hosipital Name'
            );
            var marker_hospital = new mapboxgl.Marker()
            .setLngLat([new_long,new_lat]).setPopup(popup)
            .addTo(map);
             // add popups

            </script>
	</section>
	<!-- search-result section end -->


{% endblock %}